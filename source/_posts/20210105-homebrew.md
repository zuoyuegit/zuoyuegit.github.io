---
title: Homebrew 软件包管理器
date: 2021-01-05 11:20:44
tags: MacBook
---

**目录**

[toc]

## 前言  
  Homebrew是 macOS（或 Linux）缺失的软件包的管理器。它是一款Mac OS平台下的软件包管理工具，拥有安装、卸载、更新、查看、搜索等很多实用的功能。简单的一条指令，就可以实现包管理，而不用你关心各种依赖和文件路径的情况，十分方便快捷。  

---

### 一、准备  
安装 xcode-select 工具包  
安装完成后，你将可以直接在 终端（terminal）中使用主要的命令，比如：make, GCC, clang, perl, svn, git, size, strip, strings, libtool, cpp等等。
```bash
xcode-select --install
```

---

### 二、安装  

##### 1. 官方安装命令：  

官网地址：<https://brew.sh/index_zh-cn>  

* 检查是否能够访问到 Homebrew 安装文件  
浏览器输入：<https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh>  
不能访问可通过 <https://www.ipaddress.com/>首页；输入 raw.githubusercontent.com 查询到真实IP地址，并将其写到 host 文件中  
```bash
# 编辑 host 文件
sudo vi /etc/hosts

# 添加IP映射地址
199.232.96.133 raw.githubusercontent.com
```

* 将以下命令粘贴到终端 + 回车
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh")
```

> **注意：由于Homebrew资源在国外服务器上，由于网络原因下载速度会非常慢，很可能导致安装失败**  

##### 2. 国内镜像安装：  

中科院地址：<https://mirror.tuna.tsinghua.edu.cn/help/homebrew/>

* 获取 brew_install.sh 文件，执行以下命令  
```bash
curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh >> brew_install.sh
```

* 如果失败，直接获取之前的备份文件：  
brew_install.sh 文件地址：<https://pan.baidu.com/s/1OVz1SGkM2zIGro1HmBAAUA>   密码：jcu1  

* 找到刚刚获取的 brew_install.sh 文件，并修改文件中的镜像资源（以文本编辑方式打开）  
```bash
# 修改为中科院镜像资源
# BREW_REPO="https://github.com/Homebrew/brew"
BREW_REPO="https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git"
```

* brew 运行时会从 Homebrew bottles 中拉取一个包，所以在运行前先设置个临时地址
```bash
export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles
```

* 运行 brew_install.sh 以安装 Homebrew  
```bash
bash brew_install.sh
```

* 当运行出现如下提示时：安装进度可能会卡在这一步并报错，原因是homebrew-core镜像也需要更改为中科院镜像  
```bash
==> Tapping homebrew/core Cloning into '/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core'...
```

* 报错信息如下：  
```bash
Error: Failure while executing; git clone https://github.com/Homebrew/homebrew-core /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core --depth=1 exited with 128.
Error: Failure while executing; /usr/local/bin/brew tap homebrew/core exited with 1.
```

* 此时需要更换 homebrew-core 为中科院镜像，打开终端输入命令：  
```bash
git clone git://mirrors.ustc.edu.cn/homebrew-core.git/ /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core --depth=1
```

* 关闭 Homebrew 自动更新  
```bash
# 编辑 .zshrc 文件
vi ~/.zshrc

# 新增配置
export HOMEBREW_NO_AUTO_UPDATE=true

# 使配置生效
source ~/.zshrc
```

* 最后更新 Homebrew  
```bash
brew update -v
```

##### 3. 安装Homebrew组件：   
| 名称                   | 命令                                 | 说明                                                         |
| ---------------------- | ------------------------------------ | ------------------------------------------------------------ |
| Homebrew Cask          | 现已默认集成到 Homebrew 中，无需安装 | 该组件省去了官网下载、手动拖拽安装等一系列操作；只需执行一条命令，一步安装到位 |
| homebrew-cask-versions | brew tap homebrew/cask-versions      | 该组件可以使你安装内测和历史版本                             |

---


### 三、使用  

##### 1. 常用命令：  
| 命令                   | 说明                         |
| ---------------------- | ---------------------------- |
| brew update            | 更新 Homebrew 自身           |
| brew doctor            | 检查 Homebrew 配置问题       |
| brew list              | 列出已安装软件列表           |
| brew search git        | 列出 brew 支持的软件         |
| brew info git          | 显示软件详细信息             |
| brew deps git          | 显示软件包依赖               |
| brew outdated          | 查看哪些软件有新版本可用     |
| brew cleanup           | 清理过时的软件版本           |
| ------                 | ------                       |
| brew install git       | 安装软件                     |
| brew upgrade git       | 更新软件                     |
| brew reinstall git     | 重新安装                     |
| brew uninstall git     | 卸载软件                     |
| ------                 | ------                       |
| brew outdated --greedy | 强制查看哪些软件有新版本可用 |

##### 2. Homebrew 的目录：  
| 目录                      | 说明                        |
| ------------------------- | --------------------------- |
| /usr/local/Homebrew       | Homebrew 程序本身的安装目录 |
| /usr/local/Cellar         | 存放 formula 软件的目录     |
| /usr/local/Caskroom       | 存放 cask 软件的目录        |
| /usr/local/opt            | 所有包忽略版本的存放目录    |
| /usr/local/bin            | 所有包二进制目录            |
| /usr/local/etc            | 所有包配置文件目录          |
| /usr/local/lib            | 所有包依赖库目录            |
| /usr/local/share          | 所有包文档文件目录          |
| ~/Library/Caches/Homebrew | 文件下载目录                |


---


### 四、替换或还原镜像地址  

##### 1. 替换上游其它镜像地址（可自由选择）  
（需要进入 /usr/local/Homebrew/ 目录）  
```bash
# brew 程序本身
git -C "$(brew --repo)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git

# 以下针对 mac OS 系统上的 Homebrew 组件
git -C "$(brew --repo homebrew/core)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git
git -C "$(brew --repo homebrew/cask)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask.git
git -C "$(brew --repo homebrew/cask-fonts)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-fonts.git
git -C "$(brew --repo homebrew/cask-drivers)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-drivers.git
git -C "$(brew --repo homebrew/cask-versions)" remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-versions.git

# 更换后测试工作是否正常
brew update -v
```



##### 2. 复原所有镜像地址  

（需要进入 /usr/local/Homebrew/ 目录）  
```bash
# brew 程序本身
git -C "$(brew --repo)" remote set-url origin https://github.com/Homebrew/brew.git

# 以下针对 mac OS 系统上的 Homebrew 组件
git -C "$(brew --repo homebrew/core)" remote set-url origin https://github.com/Homebrew/homebrew-core.git
git -C "$(brew --repo homebrew/cask)" remote set-url origin https://github.com/Homebrew/homebrew-cask.git
git -C "$(brew --repo homebrew/cask-fonts)" remote set-url origin https://github.com/Homebrew/homebrew-cask-fonts.git
git -C "$(brew --repo homebrew/cask-drivers)" remote set-url origin https://github.com/Homebrew/homebrew-cask-drivers.git
git -C "$(brew --repo homebrew/cask-versions)" remote set-url origin https://github.com/Homebrew/homebrew-cask-versions.git

# 更换后测试工作是否正常
brew update -v
```



---


### 五、常用软件  

待补充。。。  

| 软件名称       | 安装命令                                               | 说明                               |
| -------------- | ------------------------------------------------------ | ---------------------------------- |
| 谷歌浏览器     | brew install google-chrome                             |                                    |
| iTerm2终端     | brew install iterm2                                    | 待补充                             |
| 百度网盘       | brew install baidunetdisk                              |                                    |
| 翻译软件       | brew install bob                                       | <https://ripperhe.gitee.io/bob/#/> |
| Markdown编辑器 | brew install typora                                    |                                    |
| 快捷键插件     | brew install cheatsheet                                |                                    |
| 效率利器       | brew install alfred                                    | <https://sspai.com/post/43973>     |
| jdk1.8         | brew cask install homebrew/cask-versions/adoptopenjdk8 |                                    |

